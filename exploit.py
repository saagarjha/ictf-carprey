#!/usr/bin/env python3

import hashlib
import nclib
import struct
import sys


def solve_pow(prefix, difficulty):
	suffix = 0
	while True:
		hash = int(hashlib.sha256(prefix.encode("utf8") + struct.pack("<Q", suffix)).hexdigest(), 16)
		if (hash % 2 ** difficulty == 0):
			return suffix
		suffix += 1


if __name__ == "__main__":
	nc = nclib.Netcat((sys.argv[1], int(sys.argv[2])))
	nc.recv_until(": ".encode("utf8"))
	prefix = nc.recv_until("\n".encode("utf8")).strip().decode("utf8")
	nc.recv_until(": ".encode("utf8"))
	difficulty = nc.recv_until("\n".encode("utf8")).strip()
	nc.send_line(str(solve_pow(prefix, int(difficulty))).encode("utf8"))
	nc.send_line("fdcb00aefdcb0ce6ef5845ef404521b39def7a41eff4421313ebef0a45c904aa000000".encode("utf8"))
	print(nc.recv_all().decode("utf8"))
